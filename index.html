<!DOCTYPE html>
<html>
<head>
	<title>海淀置业</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

	<link href="{{ static_url('css/bootstrap.css') }}" rel="stylesheet">
	<link href="{{ static_url('css/ol.css') }}" rel="stylesheet">
	<link href="{{ static_url('css/bootstrap.css.map') }}" rel="stylesheet">
	<link href="{{ static_url('css/bootstrap-table.min.css') }}" rel="stylesheet">

	<script src="{{ static_url('js/jquery.1.10.2.min.js') }}"></script>
	<script src="{{ static_url('js/bootstrap.js') }}"></script>
	<script src="{{ static_url('js/ol.js') }}"></script>
	<script src="{{ static_url('js/HDmap.js') }}"></script>
	<script src="{{ static_url('js/divDrag.js') }}"></script>

	<!--Echart-->
	<script src="{{ static_url('js/echarts-all-3.js') }}"></script>
	<script src="{{ static_url('js/dataTool.min.js') }}"></script>
	<script src="{{ static_url('js/china.js') }}"></script>
	<script src="{{ static_url('js/world.js') }}"></script>
	<script src="{{ static_url('js/bmap.min.js') }}"></script>
	<script src="{{ static_url('js/echart_content.js') }}"></script>

	<!-- jQuery UI -->
	<script src="{{ static_url('js/jquery.ui.core.1.10.3.min.js') }}"></script>
	<script src="{{ static_url('js/jquery.ui.widget.1.10.3.min.js') }}"></script>
	<script src="{{ static_url('js/jquery.ui.mouse.1.10.3.min.js') }}"></script>
	<script src="{{ static_url('js/jquery.ui.draggable.1.10.3.min.js') }}"></script>

	<!-- wColorPicker -->
	<link href="{{ static_url('css/wColorPicker.min.css') }}" rel="stylesheet">
	<script src="{{ static_url('js/wColorPicker.min.js') }}"></script>
	

	<!-- wPaint -->
	<link href="{{ static_url('css/wPaint.min.css') }}" rel="stylesheet">
	<script src="{{ static_url('js/wPaint.min.js') }}"></script>
	<script src="{{ static_url('js/wPaint.menu.main.min.js') }}"></script>
	<script src="{{ static_url('js/wPaint.menu.text.min.js') }}"></script>
	<script src="{{ static_url('js/wPaint.menu.main.shapes.min.js') }}"></script>
	<script src="{{ static_url('js/wPaint.menu.main.file.min.js') }}"></script>

	<!-- jeDate -->
	<link href="{{ static_url('css/jedate.css')}}" rel="stylesheet" />
	<script src="{{ static_url('js/jedate.js') }}"></script>

	<!-- boostrap-table -->
	<link href="{{ static_url('css/bootstrap-table.css') }}" rel="stylesheet" />
	<script src="{{ static_url('js/bootstrap-table.js') }}"></script>
	<script src="{{ static_url('js/tableExport.js') }}"></script>
	<script src="{{ static_url('js/bootstrap-table-export.min.js') }}"></script>
	<script src="{{ static_url('js/bootstrap-table-zh-CN.min.js') }}"></script>



</head>

<style>
	html{height:100%;}  
	body{height:100%; margin:0px; padding:0px; position:relative;}

	.pa {position:absolute;}

	.zIndex-1 {z-index: 1;}
	.zIndex-10 {z-index: 10;}
	.zIndex-20 {z-index: 20;}

	.navigation-font{color: white; font-weight:bold}
	.width-100{width: 100%}

	.marginTop-100px{margin-top: 10px}

	.marginTop-10px{margin-top: 10px}

	.marginTop-20px{margin-top: 20px}

	.map_container{height:100%;}

	.nine_box_title{
		color: white;
		font-size: 10px;
		margin-top: 15px;
	}
	.nine_box_content{
		color: white;
		font-size: 20px;
		margin-top: -15px;
	}

	.chart_div{ 
		background:rgba(51, 51, 51, 0.4);
		text-align:center; 
		position:absolute;
	}
	
	.coor { width: 10px; height: 10px; overflow: hidden; cursor: se-resize; position: absolute; right: 0; bottom: 0; background-color: #09C; }

    .div_title {
    	text-align: center;
        height: 30px;
        width: 95%;
        background-color: silver;
        margin: 0px;
    }

    .div_title p {
    	margin: 0px;
        line-height: 30px;
        font: bold 17px 微软雅黑, arial;
    }

    .chart_style {
    	width: 800px;
    	height: 300px;
    }

    .div_title:hover {
        cursor: move;
    }

    .div_closer{
    	width: 5%;
    	height: 30px;
    	position: absolute;
    	background-color: rgba(0,0,0,0); 
    	right: 0px; 
    	top: 0px;
    	cursor: pointer;
    }

    .wpaint_container {
    	width: 70%;
    	height: 70%;
    	margin:70px auto 20px auto;
    	background-color: rgba(0,0,0,0.9); 
    }

    .container_talbe_page {
    	width: 100%;
    	height: 100%;
    	background-color: rgba(0,0,0,0.3);
    	z-index: 20;
    	position: absolute;
    	left: 0%;
    	top: 0%;
    }

    .tooltip {
        position: relative;
        background: rgba(0, 0, 0, 0.5);
        border-radius: 4px;
        color: white;
        padding: 4px 8px;
        opacity: 0.7;
        white-space: nowrap;
      }
      .tooltip-measure {
        opacity: 1;
        font-weight: bold;
      }
      .tooltip-static {
        background-color: #ffcc33;
        color: black;
        border: 1px solid white;
      }
      .tooltip-measure:before,
      .tooltip-static:before {
        border-top: 6px solid rgba(0, 0, 0, 0.5);
        border-right: 6px solid transparent;
        border-left: 6px solid transparent;
        content: "";
        position: absolute;
        bottom: -6px;
        margin-left: -7px;
        left: 50%;
      }
      .tooltip-static:before {
        border-top-color: #ffcc33;
      }
</style>

<body>

	<!-- map container -->
	<div id="map_container" class="zIndex11 map_container"></div>

	<!-- location -->
	<div id="mouse_positon" class="pa col-md-offset-1 container zIndex-10" style="left: 0%; top: 5%"></div>

	<!-- navigation -->
	<div id="map_navigation" class="pa zIndex-10 " style="right: 0%; top: 0%; background: rgba(51, 51, 51, 0.4);">
		<ul class="nav nav-pills nav-stacked">
			<li role="presentation"></li>
			<li role="presentation"><a class="navigation-font marginTop-100px" href="javascript:void(0);">用户</a></li>
			<li role="presentation"><a class="navigation-font" href="javascript:void(0);">首页</a></li>
			<li role="presentation"><a class="navigation-font" href="javascript:void(0);">投资企业</a></li>
			<li role="presentation"><a class="navigation-font" href="javascript:void(0);">重点项目</a></li>
			<li role="presentation"><a class="navigation-font marginTop-100px" href="javascript:void(0);">网点</a></li>
			<li role="presentation"><a class="navigation-font" href="javascript:void(0);">承租人</a></li>
			<li role="presentation"><a class="navigation-font" href="javascript:void(0);">经营单元</a></li>
			<li role="presentation"><a class="navigation-font marginTop-100px" href="javascript:void(0);"><span class="glyphicon glyphicon-plus"></span></a></li>
			<li role="presentation"><a class="navigation-font" href="javascript:void(0);"><span class="glyphicon glyphicon-minus"></span></a></li>
			<li role="presentation"><a class="navigation-font" href="javascript:void(0);"><span class="glyphicon glyphicon-th-list"></span></a></li>

			<li role="presentation">
				<a class="navigation-font" href="javascript:void(0);" onclick="areaSelect('Polygon')">区域选择 多边形</a>
			</li>

			<li role="presentation">
				<a class="navigation-font" href="javascript:void(0);" onclick="areaSelect('box')">区域选择 矩形</a>
			</li>

			<li role="presentation">
				<a class="navigation-font" href="javascript:void(0);" onclick="areaSelect('Circle')">区域选择 圆形</a>
			</li>

			<li role="presentation">
				<a class="navigation-font" href="javascript:void(0);" onclick="areaDelete()">区域删除</a>
			</li>
			<li role="presentation">
				<a class="navigation-font" href="javascript:void(0);" onclick="measure('LineString')">距离测量</a>
			</li>
			<li role="presentation">
				<a class="navigation-font" href="javascript:void(0);" onclick="measure('Polygon')">面积测量</a>
			</li>
		</ul>
	</div>

	<!-- search -->
	<div id="map_search" class="pa container zIndex-10" style="left: 0%; top: 10%">
		<div class="row">
			<div class="col-md-3 col-md-offset-1 input-group">
				<input id="search_input" type="text" class="form-control" placeholder="">
				<span class="input-group-btn">
					<button class="btn btn-info btn-search" onclick="search()">搜索</button>
				</span>
			</div>
		</div><!-- row -->
	</div><!-- map_search -->

	<!-- 图层改变 -->
	<div id="map_change" class="pa container zIndex-10" style="right: 10%; top: 10%; width: 70px;">
		<div class="btn btn-default" style=" width:100%; float:right" onclick="change_to_map()">
            <img src="{{ static_url('img/button1.png') }}" width="15px" height="15px">
        </div>
        <div class="btn btn-default" style=" width:100%; float:right" onclick="change_to_road()">
            <img src="{{ static_url('img/button2.png') }}" width="15px" height="15px">
        </div>
        <div class="btn btn-default" style=" width:100%; float:right" onclick="change_to_photo()">
            <img src="{{ static_url('img/button3.png') }}" width="15px" height="15px">
        </div>
	</div>

	<!-- template_button -->
	<div id="template_button" class="pa zIndex-10">
		<div class="row">
			<div class="col-md-1">
				<button type="button" class="btn btn-info" onclick="template_button_onclick()">模板</button>
			</div>
		</div>
		
	</div><!-- template_button -->

	<!-- 综合选项卡 -->
	<div id="synthesis_tab" class="pa zIndex-10 col-md-7" style="display: none;">
		<div class="row">
			<div class="col-md-2" style="background: rgba(10,200,10,0.7);">
				<h4 style="color: white">综合选项卡</h4>
				<div class="div_closer" onclick="close_div('synthesis_tab')">✖</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-12" style="background: rgba(0, 0, 0, 0); height: 300px; ">
				<!-- 左 -->
				<div id="synthesis_tab_content" class="col-md-5" style="background: rgba(0, 0, 0, 0.5); height: 300px;margin-left: -15px">
					<p style="color: white; font-size: 25px">优盛大厦 &nbsp;&nbsp;&nbsp;&nbsp;0113</p>
					<div id="synthesis_tab_content_nine" class="col-md-12">
						<div class="col-md-4">
							<p class="nine_box_title">产权分类</p>
							<p class="nine_box_content">自有</p>
						</div>
						<div class="col-md-4">
							<p class="nine_box_title">项目类型</p>
							<p class="nine_box_content">经营</p>
						</div>
						<div class="col-md-4">
							<p class="nine_box_title">建筑面积</p>
							<p class="nine_box_content">1369.3m2</p>
						</div>
						<div class="col-md-4">
							<p class="nine_box_title">安全等级</p>
							<p class="nine_box_content">A</p>
						</div>
						<div class="col-md-4">
							<p class="nine_box_title">空置率</p>
							<p class="nine_box_content">69%</p>
						</div>
						<div class="col-md-4">
							<p class="nine_box_title">租金收入比</p>
							<p class="nine_box_content">80%</p>
						</div>
						<div class="col-md-4">
							<p class="nine_box_title">总租金收入比</p>
							<p class="nine_box_content">上升</p>
						</div>
						<div class="col-md-4">
							<p class="nine_box_title">安全检查时间</p>
							<p class="nine_box_content">17/04/25</p>
						</div>
						<div class="col-md-4">
							<p class="nine_box_title">安全检查问题</p>
							<p class="nine_box_content">良好</p>
						</div>
					</div>
				</div>

				<!-- 中 -->
				<div class="col-md-1 col-md-offset-1">
					<div class="row marginTop-20px">
						<button type="button" class="btn btn-info btn-sm" onmouseover="show_QR_code('synthesis_tab')" onmouseout="hidden_QR_code('synthesis_tab')">二维码<span class="glyphicon glyphicon-chevron-right"></span></button>
					</div>
					<div class="row marginTop-20px">
						<button type="button" class="btn btn-info btn-sm" onmouseover="show_thumbnail('synthesis_tab')" onmouseout="hidden_thumbnail('synthesis_tab')">缩略图<span class="glyphicon glyphicon-chevron-right"></span></button>
					</div>
					<div class="row marginTop-20px">
						<button type="button" class="btn btn-info btn-sm">溯&nbsp;&nbsp;&nbsp;&nbsp;源<span class="glyphicon glyphicon-chevron-right"></span></button>
					</div>
					<div class="row marginTop-20px">
						<button type="button" class="btn btn-info btn-sm">投&nbsp;&nbsp;&nbsp;&nbsp;诉<span class="glyphicon glyphicon-chevron-right"></span></button>
					</div>
					<div class="row marginTop-20px">
						<button type="button" class="btn btn-info btn-sm" onclick="close_div('synthesis_tab'); show_div('detail_tab')">详&nbsp;&nbsp;&nbsp;&nbsp;细<span class="glyphicon glyphicon-chevron-right"></span></button>
					</div>
				</div>
				
				<!-- 右 -->
				<div id="synthesis_qr_code" class="col-md-offset-1 col-md-4" style="display: none;">
					<img src="{{ static_url('img/QR_code.png') }}">
				</div>

				<div id="synthesis_thumbnail" class="col-md-offset-1 col-md-4" style="display: none;">
					<img src="{{ static_url('img/slt.png') }}">
				</div>
			</div>
		</div>
	</div>

	<!-- 详细选项卡 -->
	<div id="detail_tab" class="pa zIndex-10 col-md-10" style="display: none;">

		<div class="row">
			<div class="col-md-2" style="background: rgba(10,200,10,0.7);">
				<h4 style="color: white">详细选项卡</h4>
				<div class="div_closer" onclick="close_div('detail_tab')">✖</div>
			</div>
		</div>

		<div class="row">
			<div class="col-md-12" style="background: rgba(0, 0, 0, 0); height: 400px; ">
				<!-- 左 -->
				<div class="col-md-7" style="background: rgba(0, 0, 0, 0.5); height: 100%;margin-left: -15px">
					<div class="col-md-6" style="height: 100%">
						<div class="col-md-11" style="height: 100%">
							<div class="row text-right" style="margin-top: 35px;">
								<!-- 操作 -->
								<button class="btn btn-default btn-sm" style="background: rgba(255,255,255,0.2); border: 0;"><span class="glyphicon glyphicon-zoom-in"></span></button>
								<button class="btn btn-default btn-sm" style="background: rgba(255,255,255,0.2); border: 0;"><span class="glyphicon glyphicon-zoom-out"></span></button>
								<button class="btn btn-default btn-sm" onclick="initWpaint();" style="background: rgba(255,255,255,0.2); border: 0;"><span class="glyphicon glyphicon-pencil"></span></button>
							</div>
							<div class="row" style="height: 70%; margin-top: 5px;">
								<div class="col-md-10">
									<img id="detail_pic" src="" class="img-responsive" alt="Responsive image">
									<div id="detail_pic" style="width: 100%; height: 100%"></div>
								</div>
								<div class="col-md-offset-1 col-md-1" style="margin-top: 20%">
									<div>
										<button class="btn btn-default " onclick="prePic()" style="background: rgba(255,255,255,0); border: 0;"><span class="glyphicon glyphicon-upload"></span></button>
									</div>
									<div>
										<button class="btn btn-default " onclick="nextPic()" style="background: rgba(255,255,255,0); border: 0;"><span class="glyphicon glyphicon-download"></span></button>
									</div>
								</div>						
							</div>
							<div id="pic_page_count" class="row text-center" style="color: white"></div>
						</div>
					</div>

					<div class="col-md-6" style="height: 100%">
						<p style="color: white; font-size: 25px; margin-top: 10px">优盛大厦 &nbsp;&nbsp;&nbsp;&nbsp;0113</p>
						<!-- 内容 -->
						<div class="row" style="height: 70%" id="detail_tab_content"></div>

						<div class="row" >
							<div class="col-md-1 col-md-offset-5" style="margin-bottom: 10px;">
								<button type="button" class="btn btn-default btn-sm" onclick="detail_tab_paging('left')" style="background: rgba(255,255,255,0.2); border: 0"><span class="glyphicon glyphicon-chevron-left"></span></button>
							</div>
							<div class="col-md-1">
								<button type="button" class="btn btn-default btn-sm" onclick="detail_tab_paging('right')" style="background: rgba(255,255,255,0.2); border: 0"><span class="glyphicon glyphicon-chevron-right"></span></button>
							</div>
							<div class="col-md-2 col-md-offset-1" id="detail_page_show" style="color: white">1</div>
						</div>
						
					</div>
				</div>

				<!-- 中 -->
				<div class="col-md-1" style="margin-left: 30px">
					<div class="row marginTop-20px">
						<button type="button" class="btn btn-info btn-sm" onmouseover="show_QR_code('detail_tab')" onmouseout="hidden_QR_code('detail_tab')">二维码<span class="glyphicon glyphicon-chevron-right"></span></button>
					</div>
					<div class="row marginTop-20px">
						<button type="button" class="btn btn-info btn-sm" onmouseover="show_thumbnail('detail_tab')" onmouseout="hidden_thumbnail('detail_tab')">缩略图<span class="glyphicon glyphicon-chevron-right"></span></button>
					</div>
					<div class="row marginTop-20px">
						<button type="button" class="btn btn-info btn-sm">溯&nbsp;&nbsp;&nbsp;&nbsp;源<span class="glyphicon glyphicon-chevron-right"></span></button>
					</div>
					<div class="row marginTop-20px">
						<button type="button" class="btn btn-info btn-sm">投&nbsp;&nbsp;&nbsp;&nbsp;诉<span class="glyphicon glyphicon-chevron-right"></span></button>
					</div>
				</div>

				<!-- 右 -->
				<div id="detail_qr_code" class=" col-md-2" style="display: none;">
					<img src="{{ static_url('img/QR_code.png') }}">
				</div>

				<div id="detail_thumbnail" class=" col-md-2" style="display: none;">
					<img src="{{ static_url('img/slt.png') }}">
				</div>
			</div>
		</div>
	</div>

	

	<!-- template_container -->
	<div id="template_container" class="pa zIndex-10 col-md-6" style="background: white; display: none;">
		<ul class="nav nav-tabs">
			<li role="presentation" class="active">
				<a id="branch" href="#tabs" data-toggle="tab" onclick="initTemplateContent(this);">网点信息</a>
			</li>
			<li role="presentation">
				<a id="lessee" href="#tabs" data-toggle="tab" onclick="initTemplateContent(this);">承租人信息</a>
			</li>
			<li role="presentation">
				<a id="run_unit" href="#tabs" data-toggle="tab" onclick="initTemplateContent(this);">经营单元信息</a>
			</li>
			<li role="presentation">
				<a id="merge_heat" href="#tabs" data-toggle="tab" onclick="initTemplateContent(this);">融合模板</a>
			</li>
			<li role="presentation">
				<a id="tab_branch" href="#tabs" data-toggle="tab" onclick="initTemplateContent(this);">选项卡模板</a>
			</li>
		</ul>
		<div id="tabs">
			<!-- 融合模板选项 -->
			<div id="merge_radio_select" class="row" style="display: none;">
				<label class="radio-inline col-md-offset-1">
					<input type="radio"  id="merge_heat" name="merge_radio_select" checked="" onclick="initTemplateContent(this);"> 热力图
				</label>
				<label class="radio-inline">
					<input type="radio"  id="merge_relate" name="merge_radio_select" onclick="initTemplateContent(this);"> 关系图
				</label>
				<label class="radio-inline">
					<input type="radio" " id="merge_work" name="merge_radio_select" onclick="initTemplateContent(this);"> 业态图
				</label>
			</div>

			<!-- 内容 -->
			<div id="template_checkbox" class="row marginTop-10px"></div>
		</div>

		<!-- 融合按钮 -->
		<div class="row" id="merge_div" style="display: none;">
			<label class="radio-inline col-md-offset-1">
				<input type="radio" name="merge_div" id="time_merge" checked> 时间融合
			</label>
			<label class="radio-inline">
				<input type="radio" name="merge_div" id="manage_merge"> 管理方式融合
			</label>
			<label class="radio-inline">
				<input type="radio" name="merge_div" id="street_merge"> 街道融合
			</label>
		</div>

		<!-- 底部按钮 -->
		<div class="row">
			<div class="col-md-2 col-md-offset-5">
				<button type="button" class="btn btn-default btn-sm" onclick="template_paging('left')"><span class="glyphicon glyphicon-chevron-left"></span></button>
				<span id="template_page_now">1</span>
				<span>/</span>
				<span id="template_page_num">2</span>
				<button type="button" class="btn btn-default btn-sm" onclick="template_paging('right')"><span class="glyphicon glyphicon-chevron-right"></span></button>
			</div>
			<div class="col-md-1 col-md-offset-2">
				<button type="button" class="btn btn-default" onclick="show_charts(); template_button_onclick()">应用</button>
			</div>
			<div class="col-md-1">
				<button type="button" class="btn btn-default" onclick="list_table()">列表</button>
			</div>
		</div>
	</div><!-- template_container -->

	<!-- 列表 -->
	<div id="container_talbe_page" class="container_talbe_page" style="display: none;">
		<div class="row" style="height: 100%; width: 98%">
			<div class="col-md-8 col-md-offset-2 text-center form-group form-inline" style="background: rgba(255,255,255,1); height: 92%; margin-top: 2%; margin-bottom: 2%;">
				<h4 style=" margin-top: 40px;">
					起始时间:
					<input name="date_Start" class="form-control" id="date_Start" type="text" placeholder="YYYY-MM-DD" value="">
					结束时间：
					<input name="date_End" class="form-control" id="date_End" type="text" placeholder="YYYY-MM-DD" value="">

					<button type="button" class="btn btn-default">确认</button>
					<button type="button" class="btn btn-default pull-right" onclick="close_div('container_talbe_page')">关闭</button>
				</h4>
				<div id="container_table_content" class="row text-center col-md-offset-1 col-md-10" style="margin-top: 20px;">
						
				</div>
			</div>

		</div>
	</div>

</body>

<script>

template_button_positon = 'down';
active_nav_tab = 'branch';
images = ["/static/img/ysds/1.png", '/static/img/ysds/2.png', '/static/img/123.png'];
table_list_array = [];
arr = [];
arr_is_check = [];  //0: unchecked  1:checked

window.onload = function(){
    /*初始化本地地图*/
	initHDmap();

	/*初始化css*/
	initCssSetting();

	initDetailTabContent();

	/*临时功能测试  创建可移动div*/
	/*newChartDiv('newchart');*/
	/*临时功能测试  圈选区域内marker*/
	/*myMarker1 = new mapMarker([74.0092233188324, 30.44769951985169], ' ')*/


	/*
	思路： 全局维护showList layer

	1 初始化所有 marker 存放在  markerList中
		
		list.push(myMarker)

	2 圈选是判断 markerList中的location,在内则 showList.push()

	3 map添加showList 中myMarker.vectorLayer
	*/


};

function setCenter(containerId, col, top){
	/* StringID, int colnum, string 50% */

	var w = document.body.clientWidth;
	var height = document.body.clientHeight;
	
	var containerLength = w/12 * col;
	$('#' + containerId)[0].style.left = ((w - containerLength) / w) * 50 + "%";
	$('#' + containerId)[0].style.top = top;
}

function setDivHeight(containerId, height){
	/* stringID, string 0.5 or 200px*/
	var heightIn = height + ''
	if(heightIn.indexOf('px') < 0){
		var height = document.body.clientHeight * height
		$('#' + containerId)[0].style.height = height + "px"
	}else{
		$('#' + containerId)[0].style.height = height
	}
}

function setDivWidth(containerId, width){
	/* stringID, string 0.5 or 200px*/
	var widthIn = width + ''
	if(widthIn.indexOf('px') < 0){
		var width = document.body.clientWidth * width
		$('#' + containerId)[0].style.width = width + "px"
	}else{
		$('#' + containerId)[0].style.width = width
	}
	
}

function initDetailTabPic(){
	/*step 1 得到照片集合*/
	pic_arr = ["/static/img/ysds/1.png", '/static/img/ysds/2.png', '/static/img/ysds/3.png', '/static/img/ysds/4.png']

	/*step 2 替换照片*/
	$('#detail_pic')[0].src = pic_arr[0]

	pic_now = 0;

	/*step 3 设置页数*/
	set_pic_page_count()
}

function prePic(){
	pic_now -= 1
	if (pic_now < 0) {
		pic_now = pic_arr.length - 1
	}
	$('#detail_pic')[0].src = pic_arr[pic_now]

	/* 设置页数*/
	set_pic_page_count()
}

function nextPic(){
	pic_now += 1
	if (pic_now == pic_arr.length) {
		pic_now = 0
	}
	$('#detail_pic')[0].src = pic_arr[pic_now]

	/* 设置页数*/
	set_pic_page_count()
}

function set_pic_page_count(){
	var p = pic_now + 1
	var c = pic_arr.length
	$('#pic_page_count').text(p+'/'+c)
}

function initDetailTabContent(){
	/*step 0 初始化照片*/
	initDetailTabPic()

	detail_arr = [];
	pageSize_detail = 12;
	pageNow_detail = 1;
	var divDom = $('#detail_tab_content')

	/*step 1 删除标签*/
	$('#detail_tab_content *').remove();

	/*step 2 取出数据*/
	detail_arr = [
			{'title': '产权分类', 'content': '自由'},
			{'title': '项目类型', 'content': '经营'},
			{'title': '建筑面积', 'content': '1369.3m2'},
			{'title': '土地面积', 'content': '6872.42m2'},
			{'title': '空置率', 'content': '69%'},
			{'title': '所属街道', 'content': '学院路街道'},
			{'title': '配套性质', 'content': '非配套网点'},
			{'title': '社区性质', 'content': '非社区网点'},
			{'title': '抵押情况', 'content': '抵押'},
			{'title': '网点登记地址', 'content': '柳林馆10-1'},
			{'title': '房产证情况', 'content': '部分有证'},
			{'title': '房产证编号', 'content': '3-50'},
			{'title': '房产证面积', 'content': '1258.2'},
			{'title': '无房产证面积', 'content': '111.1'},
			{'title': '有无土地证', 'content': '有'},
			{'title': '土地证编号', 'content': '123'},
			{'title': '土地征面积', 'content': '1587.12'},
			{'title': '无土地征面积', 'content': '321.4'},
			{'title': '产权分类', 'content': '自由'},
			{'title': '项目类型', 'content': '经营'},
			{'title': '建筑面积', 'content': '1369.3m2'},
			{'title': '土地面积', 'content': '6872.42m2'},
			{'title': '空置率', 'content': '69%'},
			{'title': '所属街道', 'content': '学院路街道'},
			{'title': '配套性质', 'content': '非配套网点'},
			{'title': '社区性质', 'content': '非社区网点'},
			{'title': '抵押情况', 'content': '抵押'},
			{'title': '网点登记地址', 'content': '柳林馆10-1'},
			{'title': '房产证情况', 'content': '部分有证'},
			{'title': '房产证编号', 'content': '3-50'},
			{'title': '房产证面积', 'content': '1258.2'},
			{'title': '无房产证面积', 'content': '111.1'},
			{'title': '有无土地证', 'content': '有'},
			{'title': '土地证编号', 'content': '123'},
			{'title': '土地征面积', 'content': '1587.12'},
			{'title': '土地征面积', 'content': '1587.12'},
			{'title': '土地征面积', 'content': '1587.12'},
		]

	/*step 3 添加元素*/
	pageCount_detail = Math.ceil( parseFloat(detail_arr.length)/parseFloat(pageSize_detail) );

	var forNum = Math.min(detail_arr.length, pageSize_detail)

	for(var i=0; i<forNum; i++){
		var str = 	"<div class='col-md-4'>" + 
						"<p class='nine_box_title'>"+ detail_arr[i].title +"</p>" +
						"<p class='nine_box_content'>"+ detail_arr[i].content +"</p>" +
					"</div>"
		divDom.append(str)
	}
}

function detail_tab_paging(lorr){
	if(lorr == 'left'){
		pageNow_detail -= 1;
	}
	else if(lorr == 'right'){
		pageNow_detail += 1;
	}
	
	/*step 1 删除标签*/
	$('#detail_tab_content *').remove();

	/*step 2 分页*/
	var divDom = $('#detail_tab_content');

	if(pageNow_detail == pageCount_detail+1){
		pageNow_detail = 1;
	}
	if(pageNow_detail == 0){
		pageNow_detail = pageCount_detail;
	}
	
	
	var start = (pageNow_detail-1) * pageSize_detail;
	var end = pageNow_detail * pageSize_detail;

	var end = Math.min(end, detail_arr.length);

	for(var i=start; i<end; i++){
		var str = "<div class='col-md-4'>" + 
						"<p class='nine_box_title'>"+ detail_arr[i].title +"</p>" +
						"<p class='nine_box_content'>"+ detail_arr[i].content +"</p>" +
					"</div>"
		divDom.append(str)
	}

	$('#detail_page_show').text(pageNow_detail + ' / ' + pageCount_detail)
}

function initTemplateContent(obj){
	table_list_array = []
	active_nav_tab = obj.id
	/*初始化当页模板*/
	pageSize = 8;
	pageNow = 1;
	var divDom = $('#template_checkbox')
	arr = []
	arr_is_check = []

	

	/*step 1 删除标签*/
	$('#template_checkbox label').remove();
	
	/*step 2 从数据库请求数据*/
	$.ajax({
		url: '/',
		type:'post',
		data: {
			'flag': 'template_content',
			'tableName': obj.id,
		},
		dataType: 'json',
		success: function(data){
			template_content = data.template_content
			for(var i=0; i<template_content.length; i++){
				arr.push(template_content[i])
				arr_is_check.push(0)
			}
			pageCount = Math.ceil( parseFloat(arr.length)/parseFloat(pageSize) );
			$('#template_page_now').text(1);
			$('#template_page_num').text(pageCount);

			var forNum = Math.min(arr.length, pageSize)

			for(var i=0; i<forNum; i++){
				if(arr_is_check[i] == 0){
					var str = "<label class='col-md-3'><input type='checkbox' value="+ arr[i].cn +" onclick='checkbox_check(this.value, "+i+")'>&nbsp;&nbsp;"+ arr[i].cn +"</label>"
				}
				else{
					var str = "<label class='col-md-3'><input type='checkbox' value="+ arr[i].cn +" onclick='checkbox_check(this.value, "+i+")' checked>&nbsp;&nbsp;"+ arr[i].cn +"</label>"
				}
				
				divDom.append(str)
			}
		}
	});

	/*step 3 判断是否为融合模板*/
	if (obj.id.indexOf('merge') == 0){
		$('#merge_div')[0].style.display = 'block'
		$('#merge_radio_select')[0].style.display = 'block'
	}else{
		$('#merge_div')[0].style.display = 'none'
		$('#merge_radio_select')[0].style.display = 'none'
	}

	
}

function template_paging(lorr){
	if(lorr == 'left'){
		pageNow -= 1;
	}
	else if(lorr == 'right'){
		pageNow += 1;
	}
	
	/*step 1 删除标签*/
	$('#template_checkbox *').remove();

	/*step 2 分页*/
	var divDom = $('#template_checkbox');

	if(pageNow == pageCount+1){
		pageNow = 1;
	}
	if(pageNow == 0){
		pageNow = pageCount;
	}
	
	var start = (pageNow-1) * pageSize;
	var end = pageNow * pageSize;

	var end = Math.min(end, arr.length);

	for(var i=start; i<end; i++){
		if(arr_is_check[i] == 0){
			var str = "<label class='col-md-3'><input type='checkbox' value="+ arr[i].cn +" onclick='checkbox_check(this.value, "+i+")'>&nbsp;&nbsp;"+ arr[i].cn +"</label>"
		}
		else{
			var str = "<label class='col-md-3'><input type='checkbox' value="+ arr[i].cn +" onclick='checkbox_check(this.value, "+i+")' checked>&nbsp;&nbsp;"+ arr[i].cn +"</label>"
		}
		divDom.append(str)
	}
	/*strp 3 设置页码*/
	$('#template_page_now').text(pageNow);
}

function template_button_onclick(){
	
	if(template_button_positon == 'down'){
		setCenter('template_button', 1, '10%');
		template_button_positon = 'up';
		initTemplateContent( $('#branch')[0] );
		$('#template_container')[0].style.display = 'block';

	}
	else if (template_button_positon == 'up') {
		setCenter("template_button", 1, "80%");
		template_button_positon = 'down'
		$('#template_container')[0].style.display = 'none';
	}
}

function newChartDiv(id){
	var chart_id = id + 'chart';
	/*创建div*/
	var divConten = "<div id='" +id+ "' class='chart_div zIndex-20'>" +
						"<div id='title' class='div_title'>" +
							"<p>拖拽移动</p>" +
						"</div>" +
						"<div class='div_closer' onclick='close_div(\"" + id +"\")'>✖</div>" +
						"<div id='coor' class='coor'></div>" + 
						"<div id='" +chart_id+ "' class='chart_style'>" +
					"</div>"
	

	$("body").append(divConten);
	initChart(chart_id);

	/*设置大小及位置*/
	setDivWidth(id, 0.45)
	setDivHeight(id, 0.4);
	setCenter(id, 8, "20%");

	/*设置拖动*/
	drag($('#' + id)[0], $('#' + id + ' #title')[0], $('#' + id + ' #coor')[0])

}

function show_QR_code(type){
	if (type == 'synthesis_tab') {
		$('#synthesis_qr_code')[0].style.display = 'block'
	}
	else if (type == 'detail_tab') {
		$('#detail_qr_code')[0].style.display = 'block'
	}
	
}

function hidden_QR_code(type){
	if (type == 'synthesis_tab') {
		$('#synthesis_qr_code')[0].style.display = 'none'
	}
	else if (type == 'detail_tab') {
		$('#detail_qr_code')[0].style.display = 'none'
	}
}

function show_thumbnail(type){
	if (type == 'synthesis_tab') {
		$('#synthesis_thumbnail')[0].style.display = 'block'
	}
	else if (type == 'detail_tab') {
		$('#detail_thumbnail')[0].style.display = 'block'
	}
	
}

function hidden_thumbnail(type){
	if (type == 'synthesis_tab') {
		$('#synthesis_thumbnail')[0].style.display = 'none'
	}
	else if (type == 'detail_tab') {
		$('#detail_thumbnail')[0].style.display = 'none'
	}
}

/*change base map*/
function change_to_map(){
	map.removeLayer(layer_road);
	map.removeLayer(layer_photo);
	map.addLayer(layer_map);
}

function change_to_road(){
	map.removeLayer(layer_map);
	
	map.addLayer(layer_road);
}

function change_to_photo(){
	map.removeLayer(layer_map);
	map.removeLayer(layer_road);
	map.addLayer(layer_photo);
}

function show_charts(){
	if (active_nav_tab == 'merge_heat') {
		var date = new Date();
		var id = 'merge_heat_chart' + date.getDate() + date.getMonth() + date.getHours() + date.getMinutes() + date.getSeconds();
		newChartDiv(id);
	}
}

function initCssSetting(){
	setCenter("template_button", 1, "80%");
	setCenter("template_container", 6, "20%");
	setCenter("synthesis_tab", 5, "20%");
	setCenter("detail_tab", 9, "20%");
	
	setDivHeight("tabs", 0.4);
	setDivWidth("map_navigation", '100px')
	setDivHeight("map_navigation", 1.0);
}

function show_div(id){
	$('#'+id)[0].style.display = 'block'
}

function close_div(id){
	if (id == 'synthesis_tab') {
		$('#'+id)[0].style.display = 'none'
	}
	else if (id == 'detail_tab') {
		$('#'+id)[0].style.display = 'none'
	}
	else if (id == 'container_talbe_page') {
		$('#'+id)[0].style.display = 'none';
		$('#table_remove').remove();
	}

	else{
		$('#'+id).remove()
	}
}


function initWpaint(){

	id = 'wpaint_container'
	var divConten = "<div id='wpaint_container' class='pa zIndex-10 wpaint_container zIndex-20'>" +
					"<div class='div_closer zIndex-20' style='margin-top:-20px' onclick='close_div(\"" + id +"\")'>✖</div>" +
					"</div>"
	$("body").append(divConten);

	setCenter("wpaint_container", 9, "10%");

	$.fn.wPaint.defaults = {
		path:            '/static/',                // set absolute path for images and cursors
		theme:           'standard classic', // set theme
		autoScaleImage:  true,               // auto scale images to size of canvas (fg and bg)
		autoCenterImage: true,               // auto center images (fg and bg, default is left/top corner)
		menuHandle:      true,               // setting to false will means menus cannot be dragged around
		menuOrientation: 'horizontal',       // menu alignment (horizontal,vertical)
		menuOffsetLeft:  50,                  // left offset of primary menu
		menuOffsetTop:   -50,                  // top offset of primary menu
		bg:              null,               // set bg on init
		image:           null,               // set image on init
		imageStretch:    true,              // stretch smaller images to full canvans dimensions
		onShapeDown:     null,               // callback for draw down event
		onShapeMove:     null,               // callback for draw move event
		onShapeUp:       null,                // callback for draw up event
		mode:        'pencil',  // set mode
		lineWidth:   '3',       // starting line width
		fillStyle:   '#FFFFFF', // starting fill style
		strokeStyle: '#FFFF00',  // start stroke style
		fontSize       : '12',    // current font size for text input
		fontFamily     : 'Arial', // active font family for text input
		fontBold       : false,   // text input bold enable/disable
		fontItalic     : false,   // text input italic enable/disable
		fontUnderline  : false,    // text input italic enable/disable
		saveImg        :saveImg,
		loadImgBg: loadImgBg,
        loadImgFg: loadImgFg
	};

	$('#wpaint_container').wPaint({
		image: '/static/img/ysds/1.png',       
	});
}

function loadImgBg () {

	// internal function for displaying background images modal
	// where images is an array of images (base64 or url path)
	// NOTE: that if you can't see the bg image changing it's probably
	// becasue the foregroud image is not transparent.
	this._showFileModal('bg', images);

	var _this = this;

	$.ajax({
		type: 'POST',
		url: '/',
		data: {
				flag: 'undoArray',
			},
		dataType: "json",
		success: function (resp) {

			_this.undoArray = resp.undoArray;
			_this.undoCurrent = resp.undoCurrent - 1;

		}
	});

}

Array.prototype.removeByValue = function(val) {
	for(var i=0; i<this.length; i++) {
		if(this[i] == val) {
			this.splice(i, 1);
			break;
		}
	}
}

function checkbox_check(value, index){

	if (table_list_array.indexOf(value) == -1){
		/*check*/
		table_list_array.push(value);
		arr_is_check[index] = 1;
	}
	else{
		/*uncheck*/
		table_list_array.removeByValue(value);
		arr_is_check[index] = 0;
	}
}

function loadImgFg () {

	// internal function for displaying foreground images modal
	// where images is an array of images (base64 or url path)
	this._showFileModal('fg', images);

	var _this = this;
	
	$.ajax({
		type: 'POST',
		url: '/',
		data: {
				flag: 'undoArray',
			},
		dataType: "json",
		success: function (resp) {

			_this.undoArray = resp.undoArray;
			_this.undoCurrent = resp.undoCurrent - 1;

		}
	});
}


function saveImg(imageData) {
	var _this = this;
	
	$.ajax({
		type: 'POST',
		url: '/',
		data: {
				imageData: imageData,
				flag: 'image',
				undoArray: JSON.stringify(_this.undoArray),
				undoCurrent: _this.undoCurrent,
			},
		dataType: "json",
		success: function (resp) {

			// internal function for displaying status messages in the canvas
			_this._displayStatus('Image saved successfully');

			// doesn't have to be json, can be anything
			// returned from server after upload as long
			// as it contains the path to the image url
			// or a base64 encoded png, either will work
			//resp = $.parseJSON(resp);

			// update images array / object or whatever
			// is being used to keep track of the images
			// can store path or base64 here (but path is better since it's much smaller)
			//images.push(resp.img);

			// do something with the image
			//$('#wPaint-img').attr('src', image);
		}
	});
}

function list_table(){
	$('#container_talbe_page')[0].style.display = 'block';
	initTable();
}


function initTable(){

	/*创建div*/
	var divConten = '<div id="table_remove">' +
						'<table id="table" ' +
							'data-toolbar="#toolbar" ' +
							'data-height="700" ' +
							'data-striped="true" ' +
							'data-search="true" ' +
							'data-show-export="true" ' +
							'data-show-refresh="true" ' +
							'data-show-toggle="true" ' +
							'data-show-columns="true" ' +
							'data-minimum-count-columns="2" ' +
							'data-show-pagination-switch="true" ' +
							'data-pagination="true" ' +
							'data-id-field="id" ' +
							'data-page-list="[10, 25, 50, 100, ALL]" ' +
							'data-show-footer="false" ' +
							'data-response-handler="responseHandler" ' +
							'data-search-on-enter-key="true">' +
						'</table>' +
					'</div>'
	
	$("#container_table_content").append(divConten);

	var width = Math.floor( 95 / table_list_array.length );
	var columns = []
	var data = []

	for(var i=0; i<table_list_array.length; i++){
		//表头
		columns.push({
			width: width + '%',
            //field: table_list_array[i],
            title: table_list_array[i],
            align: 'center',
            valign: 'middle'
		})
	}

	for(var i=1; i<99; i++){
		//表内容
		var tempdata = []
		for(var j=0; j<table_list_array.length; j++){
			tempdata.push(table_list_array[j] + ":" + i)
		}
		data.push(tempdata);
	}

    bootTable = $('#table').bootstrapTable({
        data: data,
        columns: columns,
    });
}

var startDate = {
    dateCell: '#date_Start',
    format: 'YYYY-MM-DD',
    isclear: true,
    isToday: false,
    okfun: function(elem, datas) {
        endDate.minDate = datas; //开始日选好后，重置结束日的最小日期

        var temp = document.getElementById("date_End").value;
        if (temp == "" || temp < datas) {
            document.getElementById("date_End").value = datas;
        }
    }
};

var endDate = {
    dateCell: '#date_End',
    format: 'YYYY-MM-DD',
    isclear: true,
    isToday: false,
    okfun: function(elem, datas) {
        startDate.maxDate = datas; //将结束日的初始值设定为开始日的最大日期

        var temp = document.getElementById("date_Start").value;
        if (temp == "" || temp > datas) {
            document.getElementById("date_Start").value = datas;
        }
    }
};

jeDate(startDate);
jeDate(endDate);
</script>

</html>